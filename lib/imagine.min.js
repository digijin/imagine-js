window.console||(console={log:function(){}}),function(){for(var a=0,b=["ms","moz","webkit","o"],c=0;c<b.length&&!window.requestAnimationFrame;++c)window.requestAnimationFrame=window[b[c]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[b[c]+"CancelAnimationFrame"]||window[b[c]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(b){var c=(new Date).getTime(),d=Math.max(0,16-(c-a)),e=window.setTimeout(function(){b(c+d)},d);return a=c+d,e}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)})}();var Imagine=function(a){Imagine.engine.registerObject(a),a.start&&a.start()};Imagine.objects=[],Imagine.addEvent=function(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent?a.attachEvent("on"+b,c):a["on"+b]=c},Imagine.Time={deltaTime:0,currentTime:0,lastTime:0,startTime:0,update:function(){var a=new Date,b=a.getTime();Imagine.Time.currentTime=b-Imagine.Time.startTime,Imagine.Time.deltaTime=(b-Imagine.Time.lastTime)/1e3,Imagine.Time.lastTime=b}},Imagine.Input=function(){Imagine.addEvent(document,"keypress",function(a){a=a||window.event;var b=a.keyCode?a.keyCode:a.charCode;c(b)}),Imagine.addEvent(document,"keyup",function(a){a=a||window.event;var b=a.keyCode?a.keyCode:a.charCode;g(b)}),Imagine.addEvent(document,"keydown",function(a){a=a||window.event;var b=a.keyCode?a.keyCode:a.charCode;h(b)});var a,b,c=function(){},d={},e={},f={},g=function(a){a=l(a),d[a]=!1,e[a]="up";for(var b=0;b<Imagine.objects.length;b++)obj=Imagine.objects[b],obj.keyup&&obj.keyup(a)},h=function(a){a=l(a),d.hasOwnProperty(a)?d[a]!==!0&&(e[a]="down"):e[a]="down",d[a]=!0;for(var b=0;b<Imagine.objects.length;b++)obj=Imagine.objects[b],obj.keydown&&obj.keydown(a)},i={axes:{Horizontal:{positive:"right",negative:"left"},Vertical:{positive:"up",negative:"down"}},mapping:{left:37,up:38,right:39,down:40}},j=function(){var c=JSON.parse(JSON.stringify(i));a=c.axes,b=c.mapping},k=function(){d={},e={},f={}},l=function(a){return"number"==typeof a?a:b.hasOwnProperty(a)?b[a]:parseInt(a)},m=function(a){return a=l(a),d.hasOwnProperty(a)?d[a]:!1},n=function(a){return a=l(a),f.hasOwnProperty(a)&&"down"==f[a]?!0:!1},o=function(a){return a=l(a),f.hasOwnProperty(a)&&"up"==f[a]?!0:!1},p=function(b){var c=m(a[b].positive),d=m(a[b].negative);return(c?1:0)+(d?-1:0)},q=function(){f=e,e={}};return j(),{axes:a,addAxis:function(b,c){a[b]=c},keypress:c,keyup:g,keydown:h,map:l,isDown:m,getKey:m,reset:k,update:q,getKeyDown:n,getKeyUp:o,getAxis:p}}(),Imagine.engine=function(){var a,b=12,c=1e3/b,d=!1,e=function(){if(!d){d=!0;var b=new Date;Imagine.Time.startTime=b.getTime(),Imagine.Time.lastTime=Imagine.Time.startTime,a=setInterval(f,c)}},f=function(){Imagine.Time.update(),Imagine.Input.update();for(var a=0;a<Imagine.objects.length;a++)obj=Imagine.objects[a],obj.update&&obj.update()},g=function(){clearInterval(a)};return e(),{reset:function(){Imagine.objects=[],Imagine.Input.reset(),d=!1,g(),e()},registerObject:function(a){Imagine.objects.push(a)},forceUpdate:f,getFPS:function(){return b},setFPS:function(d){b=d,c=1e3/b,g(),a=setInterval(f,c)}}}();